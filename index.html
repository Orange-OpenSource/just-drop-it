<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
   <title>Socket.IO peers</title>
</head>

<body>
      <ul id="messages"></ul>
    <form action="">
      <select id="users"></select>
      <input id="m" autocomplete="off" /><button>Send</button>
    </form>

</body>
  <script src="https://cdn.socket.io/socket.io-1.2.0.js"></script>
  <script src="http://code.jquery.com/jquery-1.11.1.js"></script>
    <script>
      var userID = prompt("Your name");
          var socket = io({query: 'userID='+String(userID),path:"/_ws/socket.io/"});
        <!--  var socket = io({ path: "/_ws/socket.io/"});-->
         <!--  var socket = io({ path: "/_ws/socket.io/"});-->
  <!-- var socket = io("http://nodejs-data.kermit.rd.francetelecom.fr",{ path: "/_ws/socket.io/"},{query: 'userID='+String(userID)});-->
 <!-- var socket = io.connect({query: 'userID='+String(userID)});-->
        

      $('form').submit(function(){
        var message = {
          to: $('#users').val(),
          from: userID,
          message: $('#m').val()
        }
        socket.emit('message', message);
        $('#m').val('');
        return false;
      });
      socket.on('message', function(msg){
        $('#messages').append($('<li>').text(msg.from + ': ' + msg.message));
      });
      socket.on('onlineUsers', function(users){
        $('#users').empty();
        $.each(users, function(i, user){
          if (user != userID){
            $('#users').append($('<option>').text(user));
          };
        });
      });
    </script>
    
    
</html>
